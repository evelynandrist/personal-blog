---
title: 'Reviving the Star Wars Traceroute on IPv6'
date: '2024-03-29'
lastmod: '2024-03-29'
tags: ['network']
draft: true
summary: 'Learn how to bypass school website restrictions with a local proxy instead of a VPN. This has the benefit of no latency increase and no performance decrease in contrast to using a VPN, leading to better gaming performance.'
images: ['/static/images/starwars-traceroute.png']
layout: PostBanner
---

## Introduction

Back in 2013, a bored network engineer created a great network easter egg. If you ran traceroute on his IP, the text from the beginning of the opening sequence of Star Wars Episode IV would be returned as the rDNS lookups of the hops. Unfortunately, due to the growing popularity of his [blog post](https://web.archive.org/web/20130214175909/http://beaglenetworks.net:80/post/42707829171/star-wars-traceroute), his server soon became the victim of several denial of service attacks. I decided to try to implement it on my server because I thought it was a shame. You can try it right now by running `traceroute -6 -I -m 100 obiwan.qwt.ch`.

<TOCInline toc={props.toc} exclude="Introduction" />

## Implementation

The original one was done using two Cisco routers, a spare /24 IPv4 block, and private routing tables. I don't have access to any of these things, so I decided to use IPv6. My hosting provider allows me to create PTR records for any IPv6 address in my /64 prefix, but only one at a time through the web interface, and I'm not allowed to add an rDNS zone. So the first thing I did was to manually create about 50 PTR records for ascending IP addresses.

Then I tried to actually do the routing using virtual network interfaces and static routes, but that turned out to be a lot more involved than I expected. Fortunately, I discovered Birk Blechschmidt's awesome [fakeroute](https://github.com/blechschmidt/fakeroute) Python script, which listens on a raw socket for ICMP packets and responds with a spoofed address based on the TTL, effectively allowing you to create any number of fake hops for a server. I modified the script a bit to suit my needs, you can find it [here](https://gist.github.com/kev1nbam27/d73a8da7186f89c7f473ae7526cb07c4).


Fingers crossed it doesn't get DoS'd into oblivion :)

If you have any questions or remarks, feel free to leave a comment.
